<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join the Collection | Fashion Match</title>
    <link rel="stylesheet" href="page2.css">
    <link rel="stylesheet" href="page2.css">
</head>

<body>
    <div class="login-container">
        <div class="image-section">
            <img src="wardrobe (1).png" alt="Fashion Inspiration" id="tilt-image">
        </div>

        <div class="form-section">
            <div class="form-header">
                <h2 id="form-title">Welcome <span>Back</span></h2>
                <p id="form-subtitle">Find your perfect style match today.</p>
            </div>

            <form id="auth-form">
                <div class="input-group" id="name-group" style="display: none;">
                    <label>Full Name</label>
                    <input type="text" id="user-name" placeholder="Gowripriya M J">
                </div>

                <div class="input-group">
                    <label>Email Address</label>
                    <input type="email" placeholder="alex@example.com" required>
                </div>

                <button type="submit" class="main-btn">Continue</button>
            </form>

            <div class="toggle-container">
                <p id="toggle-text">New to Fashion Match? <span onclick="toggleForm()">Create an account</span></p>
            </div>
        </div>
    </div>

    <script>
        // --- 1. Toggle between Login and Signup ---
        function toggleForm() {
            const title = document.getElementById('form-title');
            const subtitle = document.getElementById('form-subtitle');
            const nameGroup = document.getElementById('name-group');
            const toggleText = document.getElementById('toggle-text');

            if (nameGroup.style.display === "none") {
                title.innerHTML = "Curate Your <span>Style</span>";
                subtitle.innerText = "Join our community of fashion enthusiasts.";
                nameGroup.style.display = "block";
                toggleText.innerHTML = 'Already have an account? <span onclick="toggleForm()">Sign in</span>';
            } else {
                title.innerHTML = "Welcome <span>Back</span>";
                subtitle.innerText = "Find your perfect style match today.";
                nameGroup.style.display = "none";
                toggleText.innerHTML = 'New to Fashion Match? <span onclick="toggleForm()">Create an account</span>';
            }
        }

        // --- 2. 3D Tilt Effect for the Image ---
        const container = document.querySelector('.image-section');
        const image = document.getElementById('tilt-image');

        container.addEventListener('mousemove', (e) => {
            const rect = container.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const mouseX = e.clientX - centerX;
            const rotateY = (mouseX / (rect.width / 2)) * 15;
            image.style.transform = `rotateY(${rotateY}deg)`;
        });

        container.addEventListener('mouseleave', () => {
            image.style.transform = `rotateY(0deg)`;
        });

        // --- 3. Redirection to Page 3 ---
        document.getElementById('auth-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const nameInput = document.getElementById('user-name');
            const emailInput = document.querySelector('input[type="email"]');

            let finalName = nameInput.value.trim();
            const email = emailInput.value;

            // If name is empty (e.g. in Login mode), extract from email
            if (!finalName && email) {
                // Extract part before @ and capitalize first letter
                const localPart = email.split('@')[0];
                finalName = localPart.charAt(0).toUpperCase() + localPart.slice(1);
            }

            // Fallback
            if (!finalName) finalName = "Fashion Enthusiast";

            // --- User Persistence ---
            let users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            const existingUserIndex = users.findIndex(u => u.email === email);

            if (existingUserIndex === -1) {
                // New User
                users.push({ name: finalName, email: email, joined: new Date().toISOString() });
            } else {
                // Returning User
                users[existingUserIndex].lastLogin = new Date().toISOString();
                if (nameInput.value.trim()) {
                    users[existingUserIndex].name = finalName;
                } else {
                    finalName = users[existingUserIndex].name;
                }
            }

            localStorage.setItem('registeredUsers', JSON.stringify(users));
            localStorage.setItem('currentUserEmail', email);
            localStorage.setItem('userName', finalName);
            window.location.href = 'page3.html';
        });
    </script>
</body>

</html>